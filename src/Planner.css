



.planner-container {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100vw;
  min-height: 600px;
  background: #181818;
  padding: 48px 0;
  box-sizing: border-box;
}




.planner-grid {
  display: grid;
  grid-template-areas:
  "toolbar toolbar  toolbar  toolbar"
  "event   stats    stats    jewelry1"
  "helm    stats    stats    jewelry2"
  "shoulders stats  stats    jewelry3"
  "cloak   stats    stats    jewelry4"
  "body    stats    stats    ."
  "gloves  stats    stats    ."
  "belt    stats    stats    ."
  "boots   mainhand offhand  ranged";
  grid-template-columns: 64px 100px 100px 64px;
  grid-template-rows: auto repeat(8, 64px);
  gap: 12px;
  background: #222;
  padding: 32px;
  border-radius: 16px;
  box-shadow: 0 2px 16px rgba(0,0,0,0.4);
  /* Ensure absolutely-positioned children (like talisman chips) can render outside cells */
  overflow: visible;
}

/* Toolbar inline with the top row of the grid */
.toolbar {
  grid-area: toolbar;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 8px;
  padding: 4px 6px 8px 6px;
  color: #ddd;
}
.toolbar label { display: flex; align-items: center; gap: 6px; font-size: 0.95rem; }
.toolbar select, .toolbar input[type="number"] {
  background: #181818;
  color: #eee;
  border: 1px solid #333;
  border-radius: 6px;
  padding: 6px 8px;
}

/* Modal styles */
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
.modal {
  background: #1f1f1f;
  width: min(720px, 92vw);
  max-height: 80vh;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.5);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid #333;
}
.modal-title { color: #eee; font-weight: 600; }
.modal-close { background: transparent; color: #aaa; border: none; font-size: 18px; cursor: pointer; }
.modal-body { padding: 12px 16px; overflow: auto; display: flex; flex-direction: column; align-items: center; }
.item-list { display: flex; flex-direction: column; gap: 6px; width: 100%; max-width: 680px; align-items: stretch; }
.item-row { position: relative; display: flex; justify-content: space-between; align-items: center; background: #262626; color: #eee; border: 1px solid #333; border-radius: 8px; padding: 10px 12px; cursor: pointer; text-align: left; }
.item-row:hover { background: #303030; }
.item-left { display: inline-flex; align-items: center; gap: 8px; }
.item-icon { width: 24px; height: 24px; border-radius: 4px; object-fit: cover; border: 1px solid #444; background: #111; }
.item-name { font-weight: 600; }
.item-meta { display: inline-flex; align-items: center; gap: 10px; margin-left: 12px; opacity: 0.9; font-size: 0.8rem; color: #aaa; }
.item-meta .meta-il { color: inherit; }
.item-meta .meta-set { color: inherit; }
.item-slot { opacity: 0.85; font-size: 0.9rem; }
/* Rarity colors (approximations tuned to Killboard palette) */
.rarity-utility { color: #9aa0a6; }
.rarity-common { color: #e0e0e0; }
.rarity-uncommon { color: #5dd87c; }
.rarity-rare { color: #2bb3ff; }
.rarity-very_rare { color: #a78bfa; }
/* Mythic rarity color */
.rarity-mythic { color: #ff7b00; }
/* Set items: override name color irrespective of rarity */
.name-set { color: #f5c542 !important; }

.stat-field {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: center;
  background: #181818;
  border-radius: 8px;
  padding: 8px 12px;
  color: #eee;
  font-size: 0.95rem;
  box-shadow: 0 1px 4px rgba(0,0,0,0.2);
}
.stat-label {
  font-weight: 600;
}
.stat-value {
  font-size: 1.1rem;
  margin-top: 2px;
}






.planner-row {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  justify-content: center;
  gap: 0;
  position: relative;
}


.planner-left {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-right: 0;
}



.planner-right {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-left: 0;
  position: absolute;
  left: calc(48px + (64px + 8px) * 6); /* 6 slots from left + gaps */
  top: 0;
}




.planner-bottom {
  display: flex;
  flex-direction: row;
  gap: 8px;
  margin: 0 16px;
}

.planner-right {
  position: absolute;
  right: 48px;
  top: 48px;
}


.gear-slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 64px;
  height: 64px;
  background: #222;
  border: 2px solid #444;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  margin-bottom: 4px;
  position: relative;
  overflow: visible; /* allow tooltip to render outside slot */
}



.gear-icon {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  transform: none;
}

.gear-label {
  color: #eee;
  font-size: 0.8rem;
  text-align: center;
  margin-top: 2px;
}

/* Hover tooltip for gear slots */
.gear-tooltip {
  position: absolute;
  top: 0; /* align top-left of tooltip to top-right of slot/list row */
  left: calc(100% + 8px);
  background: rgba(20, 20, 20, 0.96);
  color: #f0f0f0;
  border: 1px solid #333;
  border-radius: 6px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.45);
  padding: 6px 8px;
  font-size: 0.9rem;
  white-space: normal; /* allow wrapping for rich content */
  max-width: 380px;
  /* avoid internal scrollbars; let content size adapt */
  max-height: none;
  overflow: visible;
  pointer-events: none;
  opacity: 0;
  transform: translateY(-4px);
  transition: opacity 120ms ease, transform 120ms ease;
  z-index: 9999; /* above other UI */
  text-align: left; /* left align text by default */
  word-break: break-word;
}
.gear-slot:hover .gear-tooltip,
.item-row:hover .gear-tooltip {
  opacity: 1;
  transform: translateY(0);
}
.talis-slot:hover .gear-tooltip {
  opacity: 1;
  transform: translateY(0);
}
/* Override any dynamic placement classes (kept for compatibility) */
.gear-tooltip.align-left,
.gear-tooltip.align-right,
.gear-tooltip.tip-bottom { top: 0; left: calc(100% + 8px); right: auto; bottom: auto; transform: translateY(-4px); }
.gear-slot:hover .gear-tooltip.align-left,
.gear-slot:hover .gear-tooltip.align-right,
.gear-slot:hover .gear-tooltip.tip-bottom,
.item-row:hover .gear-tooltip.align-left,
.item-row:hover .gear-tooltip.align-right,
.item-row:hover .gear-tooltip.tip-bottom { transform: translateY(0); }

/* Rich tooltip card (killboard-like) */
.tooltip-card {
  min-width: 260px;
  max-width: 360px;
  background: #0f1013;
  border: 1px solid #2a2f3b;
  border-radius: 8px;
  color: #dbe6ff;
  box-shadow: 0 16px 40px rgba(0,0,0,0.6);
  text-align: left;
}
.tooltip-card .tooltip-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px 6px 10px;
  border-bottom: 1px solid #222834;
}
.tooltip-card .tooltip-icon { width: 20px; height: 20px; border-radius: 3px; border: 1px solid #2a2f3b; background: #111; object-fit: cover; }
.tooltip-card .tooltip-name { font-weight: 700; font-size: 0.98rem; }
.tooltip-card.rarity-utility .tooltip-name { color: #9aa0a6; }
.tooltip-card.rarity-common .tooltip-name { color: #e0e0e0; }
.tooltip-card.rarity-uncommon .tooltip-name { color: #5dd87c; }
.tooltip-card.rarity-rare .tooltip-name { color: #2bb3ff; }
.tooltip-card.rarity-very_rare .tooltip-name { color: #a78bfa; }
.tooltip-card.rarity-mythic .tooltip-name { color: #ff7b00; }
/* Set item name in tooltip: override color */
.tooltip-card .tooltip-name.name-set { color: #f5c542; }
.tooltip-card .tooltip-meta { opacity: 0.9; font-size: 0.82rem; margin-top: 2px; }
.tooltip-card .tooltip-body { padding: 8px 10px; display: flex; flex-direction: column; gap: 8px; }
.tooltip-card .tooltip-section { display: flex; flex-direction: column; gap: 4px; }
.tooltip-card .section-title { font-weight: 700; font-size: 0.85rem; opacity: 0.95; color: #9ab9ff; }
.tooltip-card .stat-list, .tooltip-card .set-list { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: 2px; }
.tooltip-card .stat-line { display: flex; gap: 6px; font-size: 0.86rem; align-items: baseline; }
.tooltip-card .stat-line .plus { color: #5dd87c; font-weight: 700; }
.tooltip-card .stat-line .val { min-width: 32px; text-align: right; font-variant-numeric: tabular-nums; }
.tooltip-card .stat-line .label { opacity: 0.95; }
.tooltip-card .set-list { padding-left: 0; }
.tooltip-card .set-line { font-size: 0.84rem; opacity: 0.95; padding-left: 0; }
.tooltip-card .set-line .pc { color: #f5c542; font-weight: 700; margin-right: 4px; }
.tooltip-card .req-lines { display: flex; flex-direction: column; gap: 2px; font-size: 0.84rem; }
.tooltip-card .req-line { opacity: 0.95; }
.tooltip-card .req-line.req-unique { color: #ff7575; font-weight: 600; }
.tooltip-card .req-line.req-talis { color: #d1e77a; }
.tooltip-card .req-line.req-cr, .tooltip-card .req-line.req-rr { color: #e6d6a6; }

/* Talisman slots list */
.tooltip-card .talis-list { display: flex; flex-direction: column; gap: 3px; }
.tooltip-card .talis-line { display: inline-flex; align-items: center; gap: 6px; font-size: 0.85rem; }
.tooltip-card .talis-icon { width: 18px; height: 18px; border-radius: 3px; border: 1px solid #2a2f3b; background: #111; object-fit: cover; }
.tooltip-card .tooltip-metrics { display: flex; gap: 10px; font-size: 0.86rem; }
.tooltip-card .tooltip-metrics .metric { display: inline-flex; gap: 6px; align-items: baseline; }
.tooltip-card .tooltip-metrics .metric .k { opacity: 0.9; }
.tooltip-card .tooltip-metrics .metric .v { font-weight: 600; }
/* Rarity accent strip */
.tooltip-card.rarity-very_rare .tooltip-header { border-bottom-color: #5c3cd1; }
.tooltip-card.rarity-mythic .tooltip-header { border-bottom-color: #d4a12e; }
.tooltip-card.rarity-rare .tooltip-header { border-bottom-color: #2bb3ff; }
.tooltip-card.rarity-uncommon .tooltip-header { border-bottom-color: #5dd87c; }

/* Active set bonuses section */
.set-bonuses {
  margin-top: 8px;
  color: #ddd;
}
.set-bonuses-title {
  font-weight: 600;
  margin-bottom: 6px;
}
.set-bonuses-list {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.set-bonuses-item {
  background: #202020;
  border: 1px solid #333;
  border-radius: 6px;
  padding: 6px 8px;
}
.set-bonuses-name { font-weight: 600; margin-bottom: 4px; }
.set-bonuses-bonuses { display: flex; flex-direction: column; gap: 2px; }
.set-bonuses-bonus { font-size: 0.88rem; line-height: 1.2; text-align: left; opacity: 0.95; }

/* Stats panel inside center area */
.stats-panel {
  grid-area: stats;
  background: #1b1b1b;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 10px 12px;
  color: #eee;
  display: flex;
  flex-direction: column;
  overflow: auto;
}
.stats-lines {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.stats-separator { height: 8px; margin: 8px 0; border-top: 1px solid #2b2b2b; opacity: 0.9; }
.stats-line {
  display: flex;
  justify-content: space-between;
  font-size: 0.95rem;
}
.stats-line .label { opacity: 0.9; }
.stats-line .value { font-weight: 600; }
.stats-lines .stats-line:nth-child(odd) { background: rgba(255,255,255,0.03); border-radius: 4px; padding: 3px 6px; }
.stats-lines .stats-line:nth-child(even) { background: rgba(0,0,0,0.08); border-radius: 4px; padding: 3px 6px; }

/* Talisman mini-slots anchored to gear bottom-right, below label */
/* Grid layout: anchor mini talismans below the gear label */
.planner-grid .talis-row {
  position: absolute;
  bottom: -24px; /* place below the gear label */
  right: 0;
  display: inline-flex;
  gap: 4px;
  /* Raise above adjacent grid cells so they remain visible */
  z-index: 10;
  pointer-events: auto;
}
/* Ensure empty gear tooltip uses horizontal card (avoids column layout glitch) */
.planner-grid .gear-slot .gear-tooltip .tooltip-card{ display:block; }
.talis-slot {
  position: relative;
  width: 20px;
  height: 20px;
  background: #1a1a1a;
  border: 1px solid #333;
  border-radius: 4px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.4);
  overflow: hidden;
  z-index: 11;
}
.talis-slot.filled { border-color: #555; }
.talis-slot:hover { outline: 1px solid #666; cursor: pointer; }
.talis-icon-small {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}
.talis-clear {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 14px;
  height: 14px;
  background: #2b2b2b;
  color: #eee;
  border: 1px solid #444;
  border-radius: 50%;
  font-size: 10px;
  line-height: 12px;
  text-align: center;
  display: none;
}
.talis-slot.filled:hover .talis-clear { display: block; }

/* Legendary talisman support badges */
.legendary-badge {
  position: absolute;
  top: -6px;
  left: -6px;
  z-index: 2;
  background: linear-gradient(135deg, #f2c14e, #d4a12e);
  color: #1a1405;
  border: 1px solid #8a6b1a;
  border-radius: 6px;
  font-size: 10px;
  font-weight: 700;
  line-height: 1;
  padding: 3px 5px;
  text-transform: uppercase;
  box-shadow: 0 2px 6px rgba(0,0,0,0.35);
  pointer-events: none;
}
.legendary-chip {
  display: inline-block;
  background: linear-gradient(135deg, #f2c14e, #d4a12e);
  color: #1a1405;
  border: 1px solid #8a6b1a;
  border-radius: 10px;
  font-size: 0.7rem;
  font-weight: 700;
  padding: 2px 6px;
  margin-left: 8px;
  text-transform: uppercase;
}
